function busyIndicator(t){}String.prototype.hash=function(){for(var t=this,e=Array(this.length),o=0;o<this.length;o++)e[o]=o;return Array.prototype.map.call(e,function(e){return t.charCodeAt(e).toString(16)}).join("")},toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!0,onclick:null,showDuration:"300",hideDuration:"2000",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},Array.prototype.removeAll=function(t){var e=this.indexOf(t);e!==-1&&(this.splice(e,1),this.removeAll(t))},L.Icon.Default.imagePath="images/markers/";
angular.module("real.planet",["ui.router","leaflet-directive"]).config(["$stateProvider","$httpProvider","$urlRouterProvider","$logProvider",function(t,e,r,i){r.otherwise("/filter/"),i.debugEnabled(!1),t.state("filter",{url:"/filter/:iso3",data:{isPublic:!0},templateUrl:"views/real.planet/real.planet.html"}).state("scraping",{url:"/scraping",data:{isPublic:!1},templateUrl:"views/scraping/main.html"})}]).directive("footer",function(){return{templateUrl:"views/footer.html"}}).run(["$rootScope","$state","AuthService",function(t,e,r){t.$on("$stateChangeStart",function(i,a,n,l,o){var u=r.isAuthenticated(),c=angular.isObject(a.data)&&a.data.isPublic===!0;c||u||(i.preventDefault(),r.getAuthObject().then(function(r){var i=r.isAuthenticated===!0;return i?(e.go(a,n),void(t.currentUser=r)):(t.previos=a.name,void e.go("login"))},function(){e.go("login")}))})}]);
!function(){angular.module("real.planet").controller("stateController",["$rootScope","$scope","$state","$location","AuthService",function(o,e,n,t,r){function a(){n.go(o.previos||"planner",{},{reload:!0})}o.$on("$stateChangeSuccess",function(e,n,t,a,l){o.page=n.name,"login"!=o.page&&(o.previos=o.page),r.getAuthObject().then(function(e){o.currentUser=e})});var l=r.getSocialProviders();e.providers={google:l.google,facebook:l.facebook},e.providers.google&&(e.providers.google.fa="google-plus"),e.providers.facebook&&(e.providers.facebook.fa="facebook-square"),e.login=function(o){r.auth(o).then(a)},e.logout=function(){r.logout().then(function(){n.go("filter",{},{reload:!0})})}}])}();
!function(){function e(e,t,n,a,i,r){function c(t,n,i){a.initialize(t,n).then(function(){e.moduleManager=a.moduleManager}).then(function(){a.initDefaults(i),i?a.activateCountryByIso(i):a.evaluateMap()})}n.initialize(e,{canAddMarkers:!1,placemarkControl:!1,searchControl:!1,mapProvider:"Esri.OceanBasemap",mapOpt:{click:function(e){}}}),n.getMap().then(function(e){r.getAuthObject().then(function(n){c(e,n,t.iso3)})}),e.checkFilter=function(e){a.canChangeFilters()&&(e.checked=!e.checked,a.evaluateMap())},e.checkModule=function(e){if(a.canChangeFilters()){var t=$(e.options).filter(function(){return this.checked});$(e.options).filter(function(){this.checked=0==t.length;var n=$("#"+e.name+" input[value='"+this.alias+"']");return this.checked?n.parent().is(".active")||n.parent().button("toggle"):n.parent().is(".active")&&n.parent().button("toggle"),!1}),a.evaluateMap()}},e.selectMount=function(t){a.canChangeFilters()&&(e.moduleManager.temperature._selected=t,e.moduleManager.temperature.initDefault(),e.moduleManager.rain._selected=t,e.moduleManager.rain.initDefault(),a.monthChanged())},e.highlightHeader=function(e){return a.canChangeFilters()&&$(e.options).filter(function(){return this.checked}).length}}angular.module("real.planet").controller("filterController",["$scope","$stateParams","map","filterModules","leafletData","AuthService",e])}();
!function(){function t(t,e){var n=angular.extend(this,e);n.readAll=function(e){return t({method:"GET",url:n.baseUrl+e}).then(function(t){return t.data.data})},n.readOne=function(e,r){return t({method:"GET",url:n.baseUrl+r+"/"+e,params:{deep:!0}}).then(function(t){return t.data})},n.create=function(e,r){return t({method:"POST",url:n.baseUrl+r,data:e,params:{returnObject:!0}}).then(function(t){return toastr.success("Item was successfully added."),t}).then(function(t){return t.data})},n.update=function(e,r,u){return t({method:"PUT",url:n.baseUrl+u+"/"+e,data:r,params:{returnObject:!0}}).then(function(t){return toastr.success("Item was successfully updated."),t}).then(function(t){return t.data})},n.delete=function(e,r){return t({method:"DELETE",url:n.baseUrl+r+"/"+e,params:{returnObject:!0}}).then(function(t){return toastr.success("Item was successfully deleted."),t})}}angular.module("real.planet").service("CRUDService",["$http","endpoints",t])}();
!function(){function t(t,e,n){var r=void 0;return{getAuthObject:function(){var e=t.defer();return r?t.when(r):(e.resolve({isAuthenticated:!1}),e.promise)},getUser:function(){return r},clearUser:function(){return r=void 0,this.getAuthObject()},getSocialProviders:function(){return[]},auth:function(n,r){var i=t.defer();return Backand.socialSignIn(n).then(function(){i.resolve()},function(){Backand.socialSignUp(n).then(function(){e({method:"GET",url:Backand.getApiUrl()+"/1/query/data/createDefaultTrip"}).then(function(t){return i.resolve(),t.data},function(){i.resolve()})})}),i.promise},logout:function(){var e=t.defer();return Backand.signout().then(function(){r=void 0,n.path("/"),e.resolve()}),e.promise},isAuthenticated:function(){return void 0!==r&&r.isAuthenticated}}}angular.module("real.planet").factory("AuthService",["$q","$http","$location",t])}();
!function(){function n(){}angular.module("real.planet").service("endpoints",[n])}();
!function(){function t(t){var e=this;e._timaticRoot="https://www.timaticweb.com/cgi-bin/tim_website_client.cgi?SpecData=1&HEALTH=1&VISA=1&NA={{home}}&EM={{embr}}&DE={{dest}}&PASSTYPES=PASS&user=KLMB2C&subuser=KLMB2C",e._timatic="https://www.timaticweb.com/cgi-bin/tim_website_client.cgi?SpecData=1&VISA=1&NA={{home}}&DE={{dest}}&PASSTYPES=PASS&user=KLMB2C&subuser=KLMB2C",e._fileTemplate="country/real.planet.countries.json",e.load=function(t){var e=this;return e.initialLoad(t+e._fileTemplate).then(function(t){e.data=t})},e.initialLoad=function(e){var i=t.defer();if("undefined"!==Storage&&localStorage[e]){var a=JSON.parse(localStorage[e]);i.resolve(a)}else $.getJSON(e,function(t){"undefined"!==Storage&&(localStorage[e]=JSON.stringify(t)),i.resolve(t)});return i.promise},e.canShowTimaticLink=function(t,i){var t=e.data.filter(function(e){return e.target.toLowerCase()==t.toLowerCase()});return 1==t.length&&(t=t[0].ICO2),t.length==i.length&&t.toLowerCase()!==i.toLowerCase()},e.showTimatic=function(t,i){var t=e.data.filter(function(e){return e.target.toLowerCase()==t.toLowerCase()});if(1==t.length){t=t[0].ICO2;var a=e._timatic.replace("{{home}}",t).replace("{{dest}}",i);e.timaticWindow&&(e.timaticWindow.close(),e.timaticWindow=null),e.timaticWindow=window.open(a,"_blank","location=0,menubar=0,status=0,titlebar=0,toolbar=0,width=400")}}}angular.module("real.planet").service("dataService",["$q",t])}();
!function(){function e(e){function n(e){e.stopPropagation(),e.preventDefault()}function t(e){n(e);for(var t,a=e.target.files||e.dataTransfer.files,i=0;t=a[i];i++)r(t)}function r(n){if(n.name.indexOf(".kml")!=-1){var t=new FileReader;t.onload=function(e){var n=$.parseJSON(xml2json($.parseXML(e.target.result)).replace("\nundefined",""));a(n.kml.Document.name)},t.readAsText(n)}if(n.name.indexOf("world-heritage")!=-1){var t=new FileReader;t.onload=function(n){var t=$.parseJSON(n.target.result),r={};$.getJSON(RW.path.countries.all(),function(n){var a=n.features;$(t).filter(function(){var e=this,n=$(a).filter(function(){return this.id==e.target});if(n.length){var t=n[0].properties.name;r.hasOwnProperty(t)?r[t].push(e):r[t]=[e]}else console.log(e.target);return!0});for(var o in r){var n=r[o],d=Date.now();e.addNewTrip(o,d).then(function(e){var t=e.data[0],r={};$(n).filter(function(){var e=this;return r.hasOwnProperty(e.type)?r[e.type].push({name:e.name,description:e.shortInfo,picture:e.image,coordinates:e.lat+","+e.lng,tag:e.regionLong}):r[e.type]=[{name:e.name,description:e.shortInfo,picture:e.image,coordinates:e.lat+","+e.lng,tag:e.regionLong}],!0});for(var a in r){var o="red";switch(a){case"Mixed":o="yellow";break;case"Natural":o="green"}i({name:a,description:"",style:o,trip:t.id},r[a])}})}})},t.readAsText(n)}}function a(n){e.addNewTrip(n).then(function(e){var n=e.data[0];i({name:"Default",description:"Default collection for "+n.name,style:"red",trip:n.id},o(droppedKML.kml.Document.Placemark))})}function i(n,t){e.createCollection(n).then(function(n){$(t).each(function(){var t=this;t.collection=n.id,e.addMark(t)})})}function o(e){var n=[];return $(e).each(function(){var e=this,t=e.Point.coordinates.split(",")[1]+","+e.Point.coordinates.split(",")[0];n.push({name:e.name,coordinates:t,description:e.description||""})}),n}function d(e){var r=document.getElementById(e);r.addEventListener("dragover",n,!1),r.addEventListener("dragleave",n,!1),r.addEventListener("drop",t,!1)}var l=this;l.initialize=function(e){window.File&&window.FileList&&window.FileReader?d(e):console.log("Drag and Drop is not accessible.")}}angular.module("real.planet").service("dragDrop",["PlannerService",e])}();
!function(){function e(e,t,a,n,o,r,u,l,i,s,c,d){function g(e){switch(e){case"orange":e="#ca6531"}return e}function m(e){$(e.options).each(function(){this.checked=!1})}var p=this;p._content="../data/",p.style={country_default:function(e){return p.moduleManager.country&&p.moduleManager.country.getId()==e.getId()?{weight:0,fillColor:g("orange"),color:g("orange"),opacity:1}:{weight:0,fillColor:"transparent",color:"transparent",opacity:0}}},p.initialize=function(t,g){p.moduleManager={modules:[]},p.boundsMap=t;var h=[],v=a.load(p._content);p.moduleManager.dataService=a,h.push(v);var f=d.load(t,p._content);h.push(f);var y=n.load(t,p._content,p.style.country_default,p.activateCountry);return h.push(y),r.initUserSettings("UKR"),p.moduleManager.modules.push(r),p.moduleManager[r.name]=r,h.push(r.load(p._content)),m(o),p.moduleManager.modules.push(o),p.moduleManager[o.name]=o,h.push(o.load(p._content)),m(u),p.moduleManager.modules.push(u),p.moduleManager[u.name]=u,h.push(u.load(p._content)),m(l),p.moduleManager.modules.push(l),p.moduleManager[l.name]=l,h.push(l.load(p._content)),m(i),p.moduleManager.modules.push(i),p.moduleManager[i.name]=i,h.push(i.load(p._content)),m(s),p.moduleManager.modules.push(s),p.moduleManager[s.name]=s,h.push(s.load(p._content)),m(c),p.moduleManager.modules.push(c),p.moduleManager[c.name]=c,h.push(c.load(p._content)),e.all(h)},p.initDefaults=function(e){setTimeout(function(){$("input:checked").parent("label:not(.active)").button("toggle"),s.initDefault(),c.initDefault(),e&&(s.monthPanel().show(),c.rainPanel().show())},100)},p.evaluateMap=function(){p.activeFilters=[],$(p.moduleManager.modules).each(function(){var e=this;if(e.options){var t={name:e.name,aliases:[],origin:e},a=$(e.options).filter(function(){return this.checked&&t.aliases.push(this.alias),this.checked});a.length&&p.activeFilters.push(t)}}),p.activeFilters.length?1==p.activeFilters.length?n.layer.setStyle(p.setupSinglefilter):n.layer.setStyle(p.setupMultifilter):n.layer.setStyle(p.style.country_default),$(p.moduleManager.modules).each(function(){var e=this;e.evaluateGlobal&&e.evaluateGlobal(p.activeFilters)})},p.setupSinglefilter=function(e){var t="gray",a=p.activeFilters[0],n=a.origin.setup(e);return $.inArray(n,a.aliases)!=-1&&(t=n),{weight:0,fillColor:g(t),color:g(t),opacity:1}},p.setupMultifilter=function(e){var t="gray",a=!0;return $(p.activeFilters).each(function(){var t=this,n=t.origin.setup(e),o=JSON.parse(JSON.stringify(t.aliases));return o.push("gray"),a=$.inArray(n,o)!=-1}),a&&(t="green"),{weight:0,fillColor:g(t),color:g(t),opacity:.8}},p.monthChanged=function(){p.moduleManager.country?p.evaluateModules(p.moduleManager.country):p.evaluateMap()},p.deactivateCountry=function(){p.moduleManager.country=null,p.evaluateMap(),p.evaluateModules(),t.transitionTo("filter",null,{location:!0,notify:!1})},p.activateCountryByIso=function(e){var t=n.getCountryByIso(e),a=new L.LatLngBounds(new L.LatLng(t.c.properties.min[1],t.c.properties.min[0]),new L.LatLng(t.c.properties.max[1],t.c.properties.max[0]));p.activateCountry(t.c,t.l,a)},p.activateCountry=function(e,a,n){p.moduleManager.country&&p.moduleManager.country.getId()==e.getId()?(p.deactivateCountry(),p.boundsMap.setView(L.latLng(0,0),3)):(p.moduleManager.country=e,p.evaluateModules(e),a.setStyle(p.style.country_default),t.transitionTo("filter",{iso3:e.properties.ISO3},{location:!0,notify:!1}),p.boundsMap.fitBounds(n))},p.evaluateModules=function(e){$(p.moduleManager.modules).each(function(){var t=this;t.evaluateCountry&&t.evaluateCountry(e)})},p.canChangeFilters=function(){return null==p.moduleManager.country}}angular.module("real.planet").service("filterModules",["$q","$state","dataService","countriesService","budgetService","visaService","touristService","safetyService","internetService","temperatureService","rainService","worldHeritageService",e])}();
!function(){function e(){function e(e,t){var n=document.createElement("a");n.setAttribute("href","data:application/vnd.google-earth.kml+xml;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function t(e,t,n){var a='<?xml version="1.0" encoding="UTF-8"?><kml xmlns="http://earth.google.com/kml/2.2">{document}</kml>',l='<Style id="placemark-{style}"><IconStyle><Icon><href>http://mapswith.me/placemarks/placemark-{style}.png</href></Icon></IconStyle></Style>',o="<Placemark><name><![CDATA[{name}]]></name><description><![CDATA[{description}]]></description><styleUrl>#placemark-{style}</styleUrl><Point><coordinates>{coordinates}</coordinates></Point></Placemark>",c="</Document>",r="<Document>",i={Document:{name:t,visibility:1}},s=a.replace("{document}",json2xml(i));return $(e).each(function(){var e=this;s=s.replace(r,r+l.replace("{style}",e).replace("{style}",e))}),$(n).each(function(){var e=this;$(e.placemarks).each(function(){var t=this,n=t.coordinates.split(",")[0],a=t.coordinates.split(",")[1],l=e.name;t.description&&(l=l+"\r\n"+t.description),s=s.replace(c,o.replace("{name}",t.name).replace("{description}",l).replace("{style}",e.style).replace("{coordinates}",a+","+n)+c)})}),s}var n=this;n.styles=["red","blue","brown","green","orange","pink","purple","yellow"],n.CreateKML=function(a,l){e("MyTrip.kml",t(n.styles,a,l))}}angular.module("real.planet").service("kml",e)}();
!function(){function e(e,r,t,n){var o=this;o.bounds=new L.LatLngBounds(new L.LatLng(150,-300),new L.LatLng(-150,300)),o.markerClusterFunction=function(e){return new L.DivIcon({html:"<div><span>"+e.getChildCount()+"</span></div>",className:"marker-cluster marker-cluster-"+this.style,iconSize:new L.Point(40,40)})},o.createClusterLayer=function(e){var a={showCoverageOnHover:!1,iconCreateFunction:o.markerClusterFunction,style:e};return null==n.getUser()||n.getUser().clasterization||(a.disableClusteringAtZoom=1),new L.markerClusterGroup(a)},o.initialize=function(e,a){o.newPlacemarkLayer=new L.FeatureGroup,o.layerGroups={},o.allLayerGroupsObjects=[],o.scope=e;var n={mapProvider:"MapQuestOpen.OSM",canAddMarkers:!0,placemarkControl:!0,searchControl:!0,routeControl:!1,mapOpt:{click:function(e){if(t.placemark().isVisible())o.newPlacemarkLayer.clearLayers(),t.placemark().hide();else{var a=[e.latlng.lat,e.latlng.lng];o.addPlacemark(a,null)}}}};o.options=angular.extend(n,a||{}),o.mapId=o.options.mapId,angular.extend(o.scope,{center:{autoDiscover:!0,zoom:3},maxbounds:o.bounds,hidePlacemarkControl:function(){o.newPlacemarkLayer.clearLayers(),this._imageIsHidden=$("#placemarkImageSection:visible").length>0,t.placemark().hide()}}),r.getMap(o.mapId).then(function(e){e.addLayer(o.newPlacemarkLayer),L.tileLayer.provider(o.options.mapProvider).addTo(e),o.options.placemarkControl&&(e.addControl(t.placemark(o.scope)),$("[data-lightbox]").on("click",function(){$(this).lightBox()})),o.options.searchControl?t.isSearchPresent()?t.showSearch():(e.addControl(t.search(o.searchCallback)),t.searchStyles()):t.hideSearch(),o.options.routeControl&&t.route().addTo(e),e.on(o.options.mapOpt)})},o.resetMap=function(){o.getRouteControl().spliceWaypoints(0,o.getRouteControl().getWaypoints().length),o.routes=[],o.clearAllLayers(),o.layerGroups={}},o.getRouteControl=function(e){if(e){var a=[];return $(e).each(function(){a.push(this.latLng)}),t.route().setWaypoints(a)}return t.route()},o.getMap=function(){var a=e.defer();return r.getMap(o.mapId).then(function(e){a.resolve(e)}),a.promise},o.searchCallback=function(e,a,r){RW.map.fitBounds(e),o.addPlacemark(a,r)},o.toggleLayerGroups=function(e,a){var t=o.layerGroups[e];r.getMap(o.mapId).then(function(e){a?e.hasLayer(t)||t.addTo(e):e.hasLayer(t)&&e.removeLayer(t)})},o.clearAllLayers=function(){for(var e in o.layerGroups)o.layerGroups[e].clearLayers();o.allLayerGroupsObjects=[]},o.addLayerGroup=function(e,a,t){r.getMap(o.mapId).then(function(r){var n=[];$(a).filter(function(){var e=o.createLatLngFromStringCoordinates(this.coordinates);return this.latLng=e,n.push(o.createMarker(e,t)),o.allLayerGroupsObjects.push(this),!0}),o.layerGroups[e]||(o.layerGroups[e]=o.createClusterLayer(t),r.addLayer(o.layerGroups[e])),o.layerGroups[e].addLayers(n)})},o.addLayerGroupItem=function(e,a,t){r.getMap(o.mapId).then(function(r){var n=o.createLatLngFromStringCoordinates(a.coordinates);a.latLng=n;var l=o.createMarker(n,t);o.allLayerGroupsObjects.push(a),o.layerGroups[e]||(o.layerGroups[e]=o.createClusterLayer(t),r.addLayer(o.layerGroups[e])),o.layerGroups[e].addLayer(l)})},o.createLatLngFromStringCoordinates=function(e){var a=e.split(",")[0],r=e.split(",")[1];return[a,r]},o.createMarker=function(e,r){var n=L.icon({iconUrl:a.replace("{style}",r),iconAnchor:[9,24]}),l=L.marker(e,{icon:n}).on("click",function(e){t.placemark().show(),o.newPlacemarkLayer.clearLayers(),o.scope.placemark=$(o.allLayerGroupsObjects).filter(function(){return this.coordinates===e.latlng.lat+","+e.latlng.lng})[0],o.scope.$apply()});return o.scope.placemark=null,l},o.addPlacemark=function(e,a){o.options.canAddMarkers&&(t.placemark().show(),o.newPlacemarkLayer.clearLayers(),L.marker(e).addTo(o.newPlacemarkLayer),o.scope.placemark={name:a||"",coordinates:e.toString(),collection:{}},o.scope.$apply())}}var a="http://mapswith.me/placemarks/placemark-{style}.png";angular.module("real.planet").service("map",["$q","leafletData","MapControls","AuthService",e])}();
!function(){function n(n){var a=this;a.placemark=function(t){return a.scope=t,a._placemark||(a._placemark=L.Control.extend({onAdd:function(t){return this.html=$("#placemarkModal").html(),$("#placemarkModal").replaceWith(),this._container=n(this.html)(a.scope)[0],L.DomEvent.disableClickPropagation(this._container),this._container},hide:function(){$("#placemarksControl").hide()},show:function(){$("#placemarksControl").show()},isVisible:function(){return $("#placemarksControl:visible").length}}),a._placemark=new a._placemark),a._placemark},a.search=function(n){return a._searchControl=new L.Control.Search({container:"searchControl",url:"http://nominatim.openstreetmap.org/search?format=json&q={s}",jsonpParam:"json_callback",propertyName:"display_name",propertyLoc:["lat","lon"],circleLocation:!1,markerLocation:!1,autoType:!0,autoCollapse:!1,minLength:2,zoom:13,formatData:function(n){var a=this.options.propertyName,t={},o=this;return $(n).each(function(){var n=this;t[o._getPath(n,a)]=n}),t}}),a._searchControl.on("search_locationfound",function(a){var t=L.latLng(a.latlng.boundingbox[0],a.latlng.boundingbox[2]),o=L.latLng(a.latlng.boundingbox[1],a.latlng.boundingbox[3]),e=L.latLngBounds(t,o);n&&n(e,[a.latlng.lat,a.latlng.lon],a.text)}),a._searchControl},a.hideSearch=function(){a._searchControl&&$("#searchControl").hide()},a.showSearch=function(){a._searchControl&&$("#searchControl").show()},a.searchStyles=function(){$(".leaflet-control-search").addClass("input-group").addClass("search-exp"),$("input.search-input").addClass("form-control").show(),$("a.search-button").replaceWith('<span class="input-group-btn"><a class="search-button" href="#" title="Search..."></a></span>'),$("a.search-cancel").addClass("z-index-5")},a.isSearchPresent=function(){return $(".search-exp").length},a.route=function(){var n=L.Routing.plan(null,{addWaypoints:!1,draggableWaypoints:!1,createMarker:function(){}});return a._route||(a._route=L.Routing.control({position:"bottomleft",waypoints:null,plan:n,routeWhileDragging:!1,showAlternatives:!1})),a._route}}angular.module("real.planet").service("MapControls",["$compile",n])}();
!function(){function e(e){var a=this;a._fileTemplate="{{name}}/real.planet.{{name}}.json",a.calculate=function(e){return JSON.parse(JSON.stringify(e))},a.mapper=function(e){var a=this;return e[0]?e.map(a.calculate):e},a.load=function(e){var a=this,n=a._fileTemplate.replace("{{name}}",a.name).replace("{{name}}",a.name);return a.initialLoad(e+n).then(function(e){a.data=e})},a.initialLoad=function(a){var n=this,t=e.defer();if("undefined"!==Storage&&localStorage[a]){var r=JSON.parse(localStorage[a]);t.resolve(n.mapper(r))}else $.getJSON(a,function(e){"undefined"!==Storage&&(localStorage[a]=JSON.stringify(e)),t.resolve(n.mapper(e))});return t.promise},a.getDataItem=function(e,a){var n=e.getId(),t=null,r=$.grep(a,function(e){return e.target===n});return r.length>0&&(t=r[0]),t},a.getCountryOption=function(e,a,n){var t=null;if(e){var r=n(e);t=$(a).filter(function(){return this.alias==r}),t=t&&t.length?t[0]:{text:" ",icon:{class:""},alias:r}}return t}}angular.module("real.planet").service("baseFilterService",["$q",e])}();
!function(){function e(e,t){var i=angular.extend(this,t);i.name="budget",i.icon={i:!0,class:"icon-budget-main",text:"Budget"},i.order=2,i.options=[{alias:"blue",text:"Cheapest",checked:!1,icon:{i:!0,class:"icon-budget-green-filter",cellWidth:"25%"}},{alias:"green",text:"Really nice",checked:!1,icon:{i:!0,class:"icon-budget-yellow-filter",cellWidth:"25%"}},{alias:"yellow",text:"Can afford",checked:!1,icon:{i:!0,class:"icon-budget-orange-filter",cellWidth:"25%"}},{alias:"red",text:"Highest costs",checked:!1,icon:{i:!0,class:"icon-budget-red-filter",cellWidth:"25%"}}],i.setupCountry=function(e){return i.setup(e)},i.setup=function(e){var t=i.getDataItem(e,i.data);return t?t.alias:"gray"},i.evaluateCountry=function(e){i.activeCountry=i.getCountryOption(e,i.options,i.setup)},i.calculate=function(e){return 0===e.index?e.alias="gray":e.index<.43?e.alias="blue":e.index<.61?e.alias="green":e.index<.86?e.alias="yellow":e.alias="red",e}}angular.module("real.planet").service("budgetService",["$q","baseFilterService",e])}();
!function(){function e(e,n){var r=angular.extend(this,n);r.path="country/real.planet.countries.low.json",r.layer={},r.countries={},r.load=function(n,t,o,i){var a=e.defer();return r.initialLoad(t+r.path).then(function(e){r.layer=L.geoJson(e,{style:o,onEachFeature:function(e,n){e.getId=function(){return this.id},r.countries[e.properties.ISO3]={c:e},n.on("click",function(n){i&&i(e,r.layer,n.target.getBounds())})}}),r.layer.addTo(n);for(var t in r.countries)r.countries[t].l=r.layer;a.resolve()}),a.promise},r.getCountryByIso=function(e){return r.countries[e]}}angular.module("real.planet").service("countriesService",["$q","baseFilterService",e])}();
!function(){function e(e,t){var n=angular.extend(this,t);n.name="internet",n.icon={i:!0,class:"icon-internet-main",text:"Internet"},n.order=5,n.options=[{alias:"blue",text:"Wifi everywhere",checked:!1,icon:{i:!0,class:"icon-internet-green-filter",cellWidth:"25%"}},{alias:"green",text:"Easy access",checked:!1,icon:{i:!0,class:"icon-internet-yellow-filter",cellWidth:"25%"}},{alias:"yellow",text:"Wifi can be found",checked:!1,icon:{i:!0,class:"icon-internet-orange-filter",cellWidth:"25%"}},{alias:"red",text:"OMG no internet...",checked:!1,icon:{i:!0,class:"icon-internet-red-filter",cellWidth:"25%"}}],n.setupCountry=function(e){return n.setup(e)},n.setup=function(e){var t=n.getDataItem(e,n.data);return t?t.alias:"gray"},n.evaluateCountry=function(e){n.activeCountry=n.getCountryOption(e,n.options,n.setup)},n.calculate=function(e){return 0===e.index?e.alias="gray":e.index<15?e.alias="red":e.index<40?e.alias="yellow":e.index<75?e.alias="green":e.alias="blue",e}}angular.module("real.planet").service("internetService",["$q","baseFilterService",e])}();
!function(){function e(e,i){var t=angular.extend(this,i);t._selected=(new Date).getMonth()+1,t.name="rain",t._file="weather/real.planet.weather.json",t.icon={i:!0,class:"icon-weather-main",text:"Rains"},t.order=7,t.options=[{alias:"red",text:"No raint at all",checked:!1,icon:{i:!0,class:"icon-fire",cellWidth:"20%"}},{alias:"yellow",text:"True rare",checked:!1,icon:{i:!0,class:"icon-weather-green-filter",cellWidth:"20%"}},{alias:"green",text:"Sometimes",checked:!1,icon:{i:!0,class:"icon-weather-yellow-filter",cellWidth:"20%"}},{alias:"blue",text:"Happens",checked:!1,icon:{i:!0,class:"icon-weather-orange-filter",cellWidth:"20%"}},{alias:"white",text:"Alwais rainy",checked:!1,icon:{i:!0,class:"icon-weather-red-filter",cellWidth:"20%"}}],t.months=[{index:1,name:"Jan",class:"width-33 divider-border-vertical-right"},{index:2,name:"Feb",class:"width-34 divider-border-vertical-center"},{index:3,name:"Mar",class:"width-33 divider-border-vertical-left"},{index:4,name:"Apr",class:"width-33 divider-border-vertical-right"},{index:5,name:"May",class:"width-34 divider-border-vertical-center"},{index:6,name:"June",class:"width-33 divider-border-vertical-left"},{index:7,name:"July",class:"width-33 divider-border-vertical-right"},{index:8,name:"Aug",class:"width-34 divider-border-vertical-center"},{index:9,name:"Sept",class:"width-33 divider-border-vertical-left"},{index:10,name:"Oct",class:"width-33 divider-border-vertical-right"},{index:11,name:"Now",class:"width-34 divider-border-vertical-center"},{index:12,name:"Dec",class:"width-33 divider-border-vertical-left"}],t.initDefault=function(){t.rainPanel().find("input:radio[value='"+t._selected+"']").parent().button("toggle")},t.rainPanel=function(){return $("#"+t.name+"MonthPanel")},t.calculate=function(e){return e?e<30?"red":e<80?"yellow":e<120?"green":e<200?"blue":"white":"gray"},t.mapper=function(e){var i=e.map(function(e){return{target:e.target,months:e.months.map(function(e){return{number:e.number,alias:t.calculate(e.index),index:e.index}})}});return i},t.setup=function(e){return t.setupMonth(e,t._selected)},t.setupMonth=function(e,i){var n="gray",r=t.getDataItem(e,t.data);if(null!=r){var a=$.grep(r.months,function(e){return e.number===i});a.length&&(n=a[0].alias)}return n},t.evaluateCountry=function(e){e?($(t.months).filter(function(){this.alias=t.setupMonth(e,this.index);var i=this.alias;return this.icon=t.getCountryOption(e,t.options,function(){return i}),!0}),t.rainPanel().show(),t.activeCountry={}):($(t.months).filter(function(){return this.alias=null,this.icon=null,!0}),t.rainPanel().hide(),t.activeCountry=null)},t.evaluateGlobal=function(e){var i=$.grep(e,function(e){return e.name===t.name}).length>0;i?t.rainPanel().show():t.rainPanel().hide()}}angular.module("real.planet").service("rainService",["$q","baseFilterService",e])}();
!function(){function e(e,t){var a=angular.extend(this,t);a.name="safety",a.icon={i:!0,class:"icon-safety-main",text:"Safety"},a.order=3,a.options=[{alias:"green",text:"Safest",checked:!1,icon:{i:!0,class:"icon-safety-green-filter",cellWidth:"33%"}},{alias:"yellow",text:"Should be careful",checked:!1,icon:{i:!0,class:"icon-safety-yellow-filter",cellWidth:"34%"}},{alias:"red",text:"Always look around",checked:!1,icon:{i:!0,class:"icon-safety-red-filter",cellWidth:"33%"}}],a.setupCountry=function(e){return a.setup(e)},a.setup=function(e){var t=a.getDataItem(e,a.data);return t?t.alias:"gray"},a.evaluateCountry=function(e){a.activeCountry=a.getCountryOption(e,a.options,a.setup)},a.calculate=function(e){return 0===e.index?e.alias="gray":e.index<1.7?e.alias="green":e.index<2.4?e.alias="yellow":e.alias="red",e}}angular.module("real.planet").service("safetyService",["$q","baseFilterService",e])}();
!function(){function e(e,t){var i=angular.extend(this,t);i._selected=(new Date).getMonth()+1,i.name="temperature",i._file="weather/real.planet.weather.json",i.icon={i:!0,class:"icon-weather-main",text:"Temperature"},i.order=6,i.options=[{alias:"white",text:"Below zero",checked:!1,icon:{i:!0,class:"icon-weather-red-filter",cellWidth:"20%"}},{alias:"blue",text:"Quite cold",checked:!1,icon:{i:!0,class:"icon-weather-orange-filter",cellWidth:"20%"}},{alias:"green",text:"Just right",checked:!1,icon:{i:!0,class:"icon-weather-yellow-filter",cellWidth:"20%"}},{alias:"yellow",text:"Comfortable",checked:!1,icon:{i:!0,class:"icon-weather-green-filter",cellWidth:"20%"}},{alias:"red",text:"Hot potato",checked:!1,icon:{i:!0,class:"icon-fire",cellWidth:"20%"}}],i.months=[{index:1,name:"Jan",class:"width-33 divider-border-vertical-right"},{index:2,name:"Feb",class:"width-34 divider-border-vertical-center"},{index:3,name:"Mar",class:"width-33 divider-border-vertical-left"},{index:4,name:"Apr",class:"width-33 divider-border-vertical-right"},{index:5,name:"May",class:"width-34 divider-border-vertical-center"},{index:6,name:"June",class:"width-33 divider-border-vertical-left"},{index:7,name:"July",class:"width-33 divider-border-vertical-right"},{index:8,name:"Aug",class:"width-34 divider-border-vertical-center"},{index:9,name:"Sept",class:"width-33 divider-border-vertical-left"},{index:10,name:"Oct",class:"width-33 divider-border-vertical-right"},{index:11,name:"Now",class:"width-34 divider-border-vertical-center"},{index:12,name:"Dec",class:"width-33 divider-border-vertical-left"}],i.initDefault=function(){i.monthPanel().find("input:radio[value='"+i._selected+"']").parent().button("toggle")},i.monthPanel=function(){return $("#"+i.name+"MonthPanel")},i.calculate=function(e){return e<=0?"white":e<10?"blue":e<19?"green":e<27?"yellow":"red"},i.mapper=function(e){var t=e.map(function(e){return{target:e.target,months:e.months.map(function(e){return{number:e.number,alias:i.calculate(e.index),index:e.index}})}});return t},i.setup=function(e){return i.setupMonth(e,i._selected)},i.setupMonth=function(e,t){var n="gray",r=i.getDataItem(e,i.data);if(null!=r){var a=$.grep(r.months,function(e){return e.number===t});a.length&&(n=a[0].alias)}return n},i.evaluateCountry=function(e){e?($(i.months).filter(function(){this.alias=i.setupMonth(e,this.index);var t=this.alias;return this.icon=i.getCountryOption(e,i.options,function(){return t}),!0}),i.monthPanel().show(),i.activeCountry={}):($(i.months).filter(function(){return this.alias=null,this.icon=null,!0}),i.monthPanel().hide(),i.activeCountry=null)},i.evaluateGlobal=function(e){var t=$.grep(e,function(e){return e.name===i.name}).length>0;t?i.monthPanel().show():i.monthPanel().hide()}}angular.module("real.planet").service("temperatureService",["$q","baseFilterService",e])}();
!function(){function t(t,e){var i=angular.extend(this,e);i.name="tourist",i.icon={i:!0,class:"icon-tourists-main",text:"Tourists"},i.order=4,i.options=[{alias:"blue",text:"You are white man",checked:!1,icon:{i:!0,class:"icon-tourists-green-filter",cellWidth:"25%"}},{alias:"green",text:"Messing around",checked:!1,icon:{i:!0,class:"icon-tourists-yellow-filter",cellWidth:"25%"}},{alias:"yellow",text:"Tourist grouping",checked:!1,icon:{i:!0,class:"icon-tourists-orange-filter",cellWidth:"25%"}},{alias:"red",text:"Tourist jam",checked:!1,icon:{i:!0,class:"icon-tourists-red-filter",cellWidth:"25%"}}],i.setupCountry=function(t){return i.setup(t)},i.setup=function(t){var e=i.getDataItem(t,i.data);return e?e.alias:"gray"},i.evaluateCountry=function(t){i.activeCountry=i.getCountryOption(t,i.options,i.setup)},i.calculate=function(t){return t.index=t.population&&t.tourists?t.tourists/t.population:0,0===t.index?t.alias="gray":t.index<.2?t.alias="blue":t.index<.6?t.alias="green":t.index<.8?t.alias="yellow":t.alias="red",t}}angular.module("real.planet").service("touristService",["$q","baseFilterService",t])}();
!function(){function e(e,t){var i=angular.extend(this,t);i._file="visa/real.planet.{country}.json",i.name="visa",i.order=1,i.icon={i:!0,class:"icon-visa-main",text:"Visa"},i.options=[{alias:"blue",text:"Home country",checked:!0,icon:{i:!0,class:"icon-home",cellWidth:"25%"}},{alias:"green",text:"Don't required",checked:!0,icon:{i:!0,class:"icon-visa-green-filter",cellWidth:"25%"}},{alias:"yellow",text:"On arrival or other",checked:!0,icon:{i:!0,class:"icon-visa-yellow-filter",cellWidth:"25%"}},{alias:"red",text:"Required",checked:!0,icon:{i:!0,class:"icon-visa-red-filter",cellWidth:"25%"}}],i.initUserSettings=function(e){i._country=e,i._fileTemplate=i._file.replace("{country}",e)},i.setupCountry=function(e){return i.setup(e)},i.setup=function(e){var t=i.getDataItem(e,i.data);return t?t.alias:"gray"},i.addEvents=function(){$(document).on("change",'input:checkbox[value="schengen"],input:checkbox[value="usa"]',function(e){i._schengen=$('input:checkbox[value="schengen"]').is(":checked"),i._usa=$('input:checkbox[value="usa"]').is(":checked")})},i.evaluateCountry=function(e){if(i.activeCountry=i.getCountryOption(e,i.options,i.setup),e&&i.activeCountry.text){var t=i.getDataItem(e,i.data);t&&t.shortInfo&&(i.activeCountry.text=t.shortInfo)}},i.calculate=function(e){return"HomeCountry"===e.index&&(e.alias="blue"),"NotRequired"===e.index&&(e.alias="green"),"OnArrival"===e.index&&(e.alias="yellow"),"Required"===e.index&&(e.alias="red"),e},i.canShowTimaticLink=function(e){return i._country.toLowerCase()!==e.toLowerCase()},i.showTimatic=function(e){var t=i.data.filter(function(t){return t.target==e});if(i.timaticWindow&&(i.timaticWindow.close(),i.timaticWindow=null),1==t.length){var n=500,a=700,o=screen.width/2-n/2,c=screen.height/2-a/2;i.timaticWindow=window.open("","Detailed Visa Information","location=0,menubar=0,status=0,titlebar=0,toolbar=0,width="+n+"px,height="+a+"px,left="+o+"px,top="+c+"px"),i.timaticWindow.document.write(i.constructChildWindow(t[0]))}},i.constructChildWindow=function(e){return"<style> h2{color: #222533} .trip{display:block;}</style>"+e.fullText+"<hr>"}}angular.module("real.planet").service("visaService",["$q","baseFilterService",e])}();
!function(){function e(e){var r=this;r._fileTemplate="places/real.planet.places.json",r.markerClusterFunction=function(e){return new L.DivIcon({html:"<div><span>"+e.getChildCount()+"</span></div>",className:"marker-cluster marker-cluster-"+this.style,iconSize:new L.Point(40,40)})},r.createMarker=function(e,n){var a=L.icon({iconUrl:L.Icon.Default.imagePath+"marker-icon-"+n+".png",iconSize:[25,41],iconAnchor:[12,41]});return L.marker([e.lat,e.lng],{icon:a,title:e.type+": "+e.name}).bindPopup(r.createPopupContent(e),{keepInView:!0})},r.createPopupContent=function(e){return'<h4 class="text-center">'+e.name+'</h4><img class="img-responsive" src="'+e.image+'"></img><div><i>'+e.shortInfo+"</i></div>"},r.createLayer=function(e){return L.markerClusterGroup({iconCreateFunction:r.markerClusterFunction,style:e,spiderfyOnMaxZoom:!1,showCoverageOnHover:!1,disableClusteringAtZoom:10})},r.mapper=function(e){var n=e.filter(function(e){return"Natural"==e.type}),a=e.filter(function(e){return"Cultural"==e.type}),t=e.filter(function(e){return"Mixed"==e.type}),i=r.createLayer("green");i.addLayers(n.map(function(e){return r.createMarker(e,"green")}));var o=r.createLayer("red");o.addLayers(a.map(function(e){return r.createMarker(e,"red")}));var l=r.createLayer("orange");return l.addLayers(t.map(function(e){return r.createMarker(e,"orange")})),{'<b class="name-cluster-green">Natural</b>':i,'<b class="name-cluster-orange">Mixed</b>':l,'<b class="name-cluster-red">Cultural</b>':o}},r.load=function(e,r){var n=this;return n.initialLoad(r+n._fileTemplate).then(function(r){L.control.layers(null,r).addTo(e)})},r.initialLoad=function(r){var n=this,a=e.defer();if("undefined"!==Storage&&localStorage[r]){var t=JSON.parse(localStorage[r]);a.resolve(n.mapper(t))}else $.getJSON(r,function(e){"undefined"!==Storage&&(localStorage[r]=JSON.stringify(e)),a.resolve(n.mapper(e))});return a.promise}}angular.module("real.planet").service("worldHeritageService",["$q",e])}();